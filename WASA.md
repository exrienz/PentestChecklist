# Pentest Checklist
My Personal Common WASA Attack Type Checklist


## Common WASA Attack Type

### Server Side Request Forgery (SSRF)
In an SSRF attack, the attacker can deceive the server into accessing internal services (e.g. 127.0.0.1, localhost, ) that should be restricted within the organization. [Notes](https://xmind.works/qpyTPkxH) | [PAT](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CSRF%20Injection)

Chainable vulnerability / Requirement:
- Open Redirect
- LFI/RFI

### CORS Misconfiguration
CORS (Cross-Origin Resource Sharing) Injection is a security issue that happens when a web application wrongly sets its CORS rules, allowing attackers to misuse it. [Notes](https://xmind.works/6DIPUxIm) | [PAT](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/CORS%20Misconfiguration/README.md)

Requirement:
- Request > Origin: https://evil.com
- Response > Access-Control-Allow-Credential: true
- Response > Access-Control-Allow-Origin: https://evil.com OR Access-Control-Allow-Origin: null

### Account Takeover Attack
Exploit a range of vulnerabilities, such as weak password reset tokens, 2FA (two-factor authentication) weaknesses, and inadequate input validation. Through methods like manipulating referrers, utilizing cross-site scripting, or leveraging flaws in password reset processes, attackers maneuver their way into unauthorized account access. [PAT](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Account%20Takeover)

Via:
- [Misconfigured/weak password reset module](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Account%20Takeover#account-takeover-via-jwt)
- [XXS (Leaked cookie)](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Account%20Takeover#account-takeover-via-jwt)
- [HTTP Request Smuggling](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Account%20Takeover#account-takeover-via-jwt)
- [CSRF](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Account%20Takeover#account-takeover-via-jwt)
- [JWT](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Account%20Takeover#account-takeover-via-jwt)
- [2FA Bypasses](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Account%20Takeover#2fa-bypasses)

### API Key Abuse
APIs are the keys to an organization’s databases, so it’s essential to control who has access to them. Finding Hidden API Keys & How to Use Them. [PAT](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/API%20Key%20Leaks)

### Injection
#### Code Injection
#### Argument Injection
[Argument injection](https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Argument%20Injection#argument-injection) is similar to command injection as tainted data is passed to a command executed in a shell without proper sanitization/escaping.

List of exposed commands
- CURL
- TAR
- FIND
- WGET

### Business Logic Error
Unlike other types of security vulnerabilities like SQL injection or cross-site scripting (XSS), business logic errors do not rely on problems in the code itself (like unfiltered user input). Instead, they take advantage of the normal, intended functionality of the application, but use it in ways that the developer did not anticipate and that have undesired consequences.

**Common Business Logic Errors Examples:**

Review Feature Testing
- Unauthorized reviews without purchase verification.
- Out-of-scale ratings (e.g., 0 or negative in 1-5 scale).
- Multiple user ratings for one product (race conditions).
- File upload field vulnerability testing.
- Impersonation of other users' reviews.
- Unprotected Cross-Site Request Forgery (CSRF) checks.

Discount Code Feature Testing
- Code reuse attempts.
- Race conditions with same code.
- Mass Assignment or HTTP Parameter Pollution.
- XSS or SQL Injection in code application.
- Discounts on non-discounted items.

Delivery Fee Manipulation
- Negative delivery charge experiments.
- Activation of free delivery.

Currency Arbitrage
- Payment and refund in different currencies.

Premium Feature Exploitation
- Accessing premium sections without a subscription.
- Usability of premium features after refund.
- True/false value alteration for unauthorized access.

Refund Feature Exploitation
- Product accessibility post-refund.
- Currency arbitrage opportunities.
- Multiple refunds via cancellation.

Cart/Wishlist Exploitation
- Balancing total with negative quantities.
- Adding more products than available.
- Moving products between carts.

Thread Comment Testing
- Checking comment quantity limits.
- Exploiting race conditions for comments.
- Commenting as verified/privileged users.

Parameter Tampering
- Manipulating payment or critical fields.
- Exploiting HTTP Parameter Pollution & Mass Assignment.
- Response manipulation for bypassing restrictions.


